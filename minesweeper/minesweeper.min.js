var minesweeper=(x,y,z)=>{if(typeof x!='number'||x<2||typeof y!='number'||y<2||typeof z!='number'||z<1||z>=x*y||parseInt(x)!=x||parseInt(y)!=y||parseInt(z)!=z)return alert("Error!");var d={},e=[],f=[0],a=[0],s=[],t=[],w;$(document.currentScript).after(`<div><p id="minesweeper-status">剩余雷数:<span id="minesweeper-number">${z}</span></p><div id="minesweeper-main"style="width:${x*40}px;height:${y*40}px;border:3px solid black"></div></div>`);for(var i=1;i<=x*y;i++)a.push($(`<div style="width:38px;height:38px;border:1px solid black;background:#5ad7d7;float:left;text-align:center;font-size:28px"qwq=${i}></div>`));for(var i=1;i<=x*y;i++)$('#minesweeper-main').append(a[i]);for(var i=1;i<=x*y;i++)d[i]=(i=>{if(i==1)return[2,x+1,x+2];if(i==x)return[x-1,x*2-1,x*2];if(i==x*(y-1)+1)return[x*(y-2)+1,x*(y-2)+2,x*(y-1)+2];if(i==x*y)return[x*(y-1)-1,x*(y-1),x*y-1];if(i<x)return[i-1,i+1,i+x-1,i+x,i+x+1];if(i>x*(y-1)+1)return[i-1,i+1,i-x-1,i-x,i-x+1];if(i%x==1)return[i-x,i+x,i-x+1,i+1,i+x+1];if(!(i%x))return[i-x,i+x,i-x-1,i-1,i+x-1];return[i-x-1,i-x,i-x+1,i-1,i+1,i+x-1,i+x,i+x+1]})(i),e.push(i),f.push(0);e.sort(()=>Math.random()-.5),w=z;for(var i=0;i<z;i++)f[e[i]]=-1;for(var i=1;i<=x*y;i++)if(!f[i])for(var j=0;j<d[i].length;j++)if(f[d[i][j]]==-1)f[i]++;open=i=>{if(s.includes(i))return;if(f[i]==-1){for(var j=1;j<=x*y;j++){a[j].click(()=>!1),a[j].contextmenu(()=>!1);if(f[j]==-1)a[j].css("background","red")}$('#minesweeper-status').css("color","red"),alert("你踩雷了!");return!0}a[i].css("background","white"),s=s.concat([i]);if(f[i])a[i].text(f[i]);else for(var j=0;j<d[i].length;j++)if(open(d[i][j]))return!0;return!1};for(var i=1;i<=x*y;i++)a[i].click(_=>{var i=parseInt(_.target.getAttribute('qwq'));if(t.includes(i)){t.splice(t.indexOf(i),1),w++,a[i].css("background","#5ad7d7"),$('#minesweeper-number').text(w);return!1}if(open(i))return!1;if(s.length>=x*y-z){for(var j=1;j<=x*y;j++){a[j].click(()=>!1),a[j].contextmenu(()=>!1);if(f[j]==-1)a[j].css("background","red")}$('#minesweeper-number').text(0),$('#minesweeper-status').css("color","green"),alert("你获胜了!")}return!1}),a[i].contextmenu(_=>{var i=parseInt(_.target.getAttribute('qwq'));if(s.includes(i))return!1;if(t.includes(i))t.splice(t.indexOf(i),1),w++,a[i].css("background","#5ad7d7");else t=t.concat([i]),w--,a[i].css("background","red");$('#minesweeper-number').text(w);return!1}),a[i].dblclick(()=>!1)}